<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AgroCalc Pro | Levantamento Profissional de Irrigação</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
:root{
--verde:#145a32;
--verde-claro:#27ae60;
--bg:#f4f7f6;
}

body{font-family:Arial;background:var(--bg);margin:0}

header{
background:var(--verde);
color:white;
padding:22px;
text-align:center;
}

.container{
max-width:1100px;
margin:25px auto;
background:white;
padding:25px;
border-radius:14px;
box-shadow:0 8px 22px rgba(0,0,0,.08);
}

h2{color:var(--verde);margin-top:0}
h3{color:#1e8449;margin-bottom:5px}

.grid{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
gap:14px;
}

input,select,textarea{
width:100%;
padding:10px;
border-radius:8px;
border:1px solid #ccc;
margin-bottom:10px;
}

textarea{min-height:90px}

button{
width:100%;
padding:14px;
border:none;
border-radius:10px;
background:var(--verde);
color:white;
font-weight:bold;
cursor:pointer;
font-size:15px;
}

button:hover{background:#0e3d22}

.hidden{display:none}

.relatorio{
white-space:pre-line;
background:#fafafa;
padding:20px;
border-radius:10px;
border:1px solid #eee;
}
</style>
</head>
<body>

<header>
<h1>AgroCalc Pro</h1>
<p>Levantamento Técnico Profissional para Projetos de Irrigação</p>
</header>

<!-- ================= FORM ================= -->
<div class="container" id="formBox">

<h2>Formulário de Campo</h2>

<!-- 1 -->
<h3>1. Identificação da Propriedade</h3>
<div class="grid">
<input id="proprietario" placeholder="Proprietário">
<input id="nomeProp" placeholder="Nome da propriedade">
<input id="municipio" placeholder="Município/UF">
<input id="coord" placeholder="Coordenadas geográficas">
<input id="areaTotal" placeholder="Área total (ha)" type="number">
<input id="areaIrrigada" placeholder="Área irrigada (ha)" type="number">
<input id="dataVisita" type="date">
<input id="responsavel" placeholder="Responsável técnico">
</div>

<!-- 2 -->
<h3>2. Caracterização da Cultura</h3>
<div class="grid">
<input id="cultura" placeholder="Cultura principal">
<input id="variedade" placeholder="Variedade">
<input id="espacamento" placeholder="Espaçamento">
<select id="estagio">
<option>Inicial</option>
<option>Desenvolvimento</option>
<option>Floração</option>
<option>Produção</option>
</select>
<input id="demanda" placeholder="Demanda hídrica (mm/dia)" type="number">
</div>

<!-- 3 -->
<h3>3. Caracterização do Solo</h3>
<div class="grid">
<input id="classeSolo" placeholder="Classe do solo">
<select id="textura">
<option>Arenosa</option>
<option>Média</option>
<option>Argilosa</option>
</select>
<input id="profSolo" placeholder="Profundidade efetiva (cm)" type="number">
<input id="cc" placeholder="Capacidade de campo (%)" type="number">
<input id="pmp" placeholder="Ponto de murcha (%)" type="number">
<input id="infiltracao" placeholder="Infiltração básica (mm/h)" type="number">
</div>

<textarea id="obsDrenagem" placeholder="Observações sobre drenagem"></textarea>

<!-- 5 -->
<h3>5. Fonte de Água</h3>
<div class="grid">
<input id="vazaoFonte" placeholder="Vazão disponível (m³/h)" type="number">
<input id="distancia" placeholder="Distância até área (m)" type="number">
<input id="ph" placeholder="pH da água" type="number">
<input id="ce" placeholder="Condutividade elétrica (dS/m)" type="number">
</div>

<!-- 7 -->
<h3>7. Sistema de Irrigação Pretendido</h3>
<div class="grid">
<select id="metodo">
<option>Gotejamento</option>
<option>Microaspersão</option>
<option>Aspersão convencional</option>
<option>Pivô central</option>
<option>Sulco</option>
</select>
<input id="eficiencia" placeholder="Eficiência (%)" type="number" value="90">
<input id="tempoIrrig" placeholder="Tempo de irrigação (h/dia)" type="number">
</div>

<!-- 9 -->
<h3>9. Aspectos Climáticos</h3>
<div class="grid">
<input id="precip" placeholder="Precipitação anual (mm)" type="number">
<input id="eto" placeholder="ETo (mm/dia)" type="number">
<input id="vento" placeholder="Velocidade do vento (m/s)" type="number">
</div>

<!-- 10 -->
<h3>10. Aspectos Econômicos</h3>
<div class="grid">
<input id="orcamento" placeholder="Orçamento disponível (R$)" type="number">
<input id="maoObra" placeholder="Mão de obra disponível">
</div>

<textarea id="obsGerais" placeholder="Observações gerais"></textarea>

<button onclick="gerarDiagnostico()">Gerar Diagnóstico Técnico</button>
</div>

<!-- ================= RELATORIO ================= -->
<div class="container hidden" id="relatorioBox">
<h2>Diagnóstico e Recomendações Técnicas</h2>
<div class="relatorio" id="relatorio"></div>
<button onclick="baixarPDF()">Baixar PDF</button>
<button onclick="location.reload()">Novo Levantamento</button>
</div>

<script>
let textoFinal="";

function gerarDiagnostico(){

const cultura=document.getElementById("cultura").value;
const area=parseFloat(document.getElementById("areaIrrigada").value);
const demanda=parseFloat(document.getElementById("demanda").value);
const eficiencia=parseFloat(document.getElementById("eficiencia").value);
const vazaoFonte=parseFloat(document.getElementById("vazaoFonte").value);
const tempo=parseFloat(document.getElementById("tempoIrrig").value);

if(!area||!demanda||!eficiencia){
alert("Preencha os dados mínimos.");
return;
}

const areaM2=area*10000;
const volumeDia=areaM2*demanda/1000;
const vazaoNecessaria=(volumeDia*1000)/(tempo*(eficiencia/100));

let status="";
if(vazaoFonte*1000>=vazaoNecessaria) status="Fonte hídrica suficiente.";
else status="Fonte hídrica pode ser limitante — avaliar reservação.";

textoFinal=
`DIAGNÓSTICO TÉCNICO — AGROCALC PRO

Cultura: ${cultura}
Área irrigada: ${area} ha

Demanda hídrica informada: ${demanda} mm/dia
Volume diário estimado: ${volumeDia.toFixed(2)} m³/dia
Vazão requerida do sistema: ${vazaoNecessaria.toFixed(2)} L/h

ANÁLISE DA FONTE:
${status}

RECOMENDAÇÕES TÉCNICAS (baseadas em manuais da Embrapa):

• Validar a evapotranspiração local (ETo).
• Confirmar capacidade de infiltração do solo.
• Realizar teste de uniformidade do sistema.
• Verificar perdas de carga na adutora.
• Avaliar necessidade de filtragem da água.
• Ajustar turno de rega conforme estágio fenológico.
• Monitorar umidade do solo durante a operação.

OBSERVAÇÃO:
Este relatório é preliminar e deve subsidiar o projeto executivo de irrigação.`;

document.getElementById("formBox").classList.add("hidden");
document.getElementById("relatorioBox").classList.remove("hidden");
document.getElementById("relatorio").innerText=textoFinal;
}

async function baixarPDF(){
const {jsPDF}=window.jspdf;
const doc=new jsPDF();
const linhas=doc.splitTextToSize(textoFinal,180);
doc.text(linhas,10,10);
doc.save("Diagnostico_AgroCalc_Pro.pdf");
}
</script>

</body>
</html>